#!/usr/bin/env bash

# This script lists all pictures inside BACKGROUNDS and uses fzf
# to select one to set as wallpaper.
# It is intended to be used as such: $TERMINAL -T __fuzzy__ -e fwall


BACKGROUNDS="$HOME/Pictures/backgrounds"
[[ -z "$(\ls -A $BACKGROUNDS 2>/dev/null)" ]] && exit 1
\cd "$BACKGROUNDS"

FILE="$(\ls | fzf --ansi --preview 'mess {}' --preview-window 'right,70%,border-sharp' --prompt="fwall > " --height 100% --margin 0% --reverse --info=hidden --header-first)"
[[ -z "$FILE" ]] && exit 1

id=$(xdo id); xdo hide
nohup sh -c "feh --bg-fill $BACKGROUNDS/$FILE 2>/dev/null" &>/tmp/fwall.out & disown
xdo close "$id"
