#!/usr/bin/env bash


_launch () {
    CHOICE=$(echo -e "$USER\nroot" | dmenu -i -b -p USER | cut -d ':' -f 1)
    case "$CHOICE" in
        $USER)
            "$*"
            ;;
        root)
            pkexec env DISPLAY=$DISPLAY XAUTHORITY=$XAUTHORITY "$*"
            ;;
    esac
}


if [[ -x "$(command -v qt5ct)" ]]; then
    NAMES="Qt5ct"
fi

if [[ -x "$(command -v lxappearance)" ]]; then
    [[ ! -n $NAMES ]] && NAMES="Lxappearance" || NAMES="Lxappearance\n"$NAMES
fi

if [[ -x "$(command -v arandr)" ]]; then
    [[ ! -n $NAMES ]] && NAMES="Arandr" || NAMES="Arandr\n"$NAMES
fi

if [[ -x "$(command -v gparted)" ]]; then
    [[ ! -n $NAMES ]] && NAMES="Gparted" || NAMES="Gparted\n"$NAMES
fi

if [[ -x "$(command -v xarchiver)" ]]; then
    [[ ! -n $NAMES ]] && NAMES="Xarchiver" || NAMES="Xarchiver\n"$NAMES
fi

if [[ -x "$(command -v pcmanfm)" ]]; then
    [[ ! -n $NAMES ]] && NAMES="Pcmanfm" || NAMES="Pcmanfm\n"$NAMES
fi

if [[ ! -n $NAMES ]]; then
    dmenu_run -i -b -p MENU
    exit 0
fi


CHOICE=$(echo -e "$NAMES" | dmenu -i -b -p FLOAT | cut -d ':' -f 1)
case "$CHOICE" in
    Pcmanfm)
        _launch "pcmanfm"
        ;;
    Xarchiver)
        _launch "xarchiver"
        ;;
    Gparted)
        gparted
        ;;
    Arandr)
        _launch "arandr"
        ;;
    Lxappearance)
        _launch "lxappearance"
        ;;
    Qt5ct)
        _launch "qt5ct"
        ;;
    *)
        exit 1
        ;;
esac
