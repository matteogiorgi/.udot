#!/usr/bin/env bash


if [[ -x "$(command -v uxterm)" ]]; then
    NAMES="UXterm"
fi

if [[ -x "$(command -v xterm)" ]]; then
    [[ ! -n $NAMES ]] && NAMES="Xterm" || NAMES="Xterm\n"$NAMES
fi

if [[ -x "$(command -v urxvt)" ]]; then
    [[ ! -n $NAMES ]] && NAMES="Urxvt" || NAMES="Urxvt\n"$NAMES
fi

if [[ -x "$(command -v st)" ]]; then
    [[ ! -n $NAMES ]] && NAMES="ST" || NAMES="ST\n"$NAMES
fi

if [[ -x "$(command -v kitty)" ]]; then
    GLX=$(glxinfo | awk '/OpenGL version/ {print $4}')
    if (( $(echo "$GLX > 3.3" | bc -l) )); then
        [[ ! -n $NAMES ]] && NAMES="Kitty" || NAMES="Kitty\n"$NAMES
    fi
fi

if [[ ! -n $NAMES ]]; then
    dmenu_run -i -b -p MENU
    exit 0
fi


CHOICE=$(echo -e "$NAMES" | dmenu -i -b -p TERMINAL | cut -d ':' -f 1)
case "$CHOICE" in
    Kitty)
        kitty
        ;;
    ST)
        st
        ;;
    Urxvt)
        urxvt
        ;;
    Xterm)
        xterm
        ;;
    UXterm)
        uxterm
        ;;
    *)
        exit 1
        ;;
esac
