#!/usr/bin/env bash


_launch () {
    NAME="$1"; COMMAND="$2"
    CHOICE=$(echo -e "Open\nStartpage\nNotewiki\n\$HOME\nIncognito" | dmenu -i -b -p $NAME | cut -d ':' -f 1)
    case "$CHOICE" in
        Open)
            $COMMAND
            ;;
        Startpage)
            $COMMAND --new-window https://www.geoteo.net/start
            ;;
        Notewiki)
            $COMMAND --new-window $HOME/notewiki/pandoc/index.html
            ;;
        \$HOME)
            $COMMAND --new-window $HOME
            ;;
        Incognito)
            $COMMAND --new-window -incognito
            ;;
        *)
            exit 1
            ;;
    esac
}


if [[ -x "$(command -v brave)" ]]; then
    NAMES="Brave"
fi
if [[ -x "$(command -v chromium)" ]]; then
    [[ ! -n $NAMES ]] && NAMES="Chromium" || NAMES="Chromium\n"$NAMES
fi
if [[ -x "$(command -v google-chrome)" ]]; then
    [[ ! -n $NAMES ]] && NAMES="Chrome" || NAMES="Chrome\n"$NAMES
fi
if [[ ! -n $NAMES ]]; then
    dmenu_run -i -b -p MENU
    exit 0
fi


CHOICE=$(echo -e "$NAMES" | dmenu -i -b -p BROWSER | cut -d ':' -f 1)
case "$CHOICE" in
    Chrome)
        _launch "CHROME" "google-chrome"
        ;;
    Chromium)
        _launch "CHROMIUM" "chromium"
        ;;
    Brave)
        _launch "BRAVE" "brave"
        ;;
    *)
        exit 1
        ;;
esac
