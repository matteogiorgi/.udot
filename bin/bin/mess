#!/usr/bin/env bash

[[ "$@" == "" ]] && exit 1

MESS="/bin/less -R"
LIST="/bin/ls -ANgoh --ignore=".git" --group-directories-first --color=always"

# install source-highlight and use src-hilite-lesspipe.sh to preview
# with colors, otherwise /bin/cat will be used instead
[[ -f "/usr/share/source-highlight/src-hilite-lesspipe.sh" ]] \
    && PRINT="/usr/share/source-highlight/src-hilite-lesspipe.sh" \
    || PRINT="/bin/cat"

if [[ -L "$@" && -d "$@" ]]; then
    ${LIST} "$(readlink $@)" | ${MESS}
elif [[ -d "$@" ]]; then
    ${LIST} "$@" | ${MESS}
else
    ${PRINT} "$@" | ${MESS}
fi
