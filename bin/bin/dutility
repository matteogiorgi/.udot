#!/usr/bin/env bash


_launch () {
    CHOICE=$(echo -e "$USER\nroot" | dmenu -i -b -p USER | cut -d ':' -f 1)
    case "$CHOICE" in
        $USER)
            "$*"
            ;;
        root)
            pkexec env DISPLAY=$DISPLAY XAUTHORITY=$XAUTHORITY "$*"
            ;;
    esac
}


if [[ -x "$(command -v qt5ct)" ]]; then
    NAMES="Qt5ct"
fi
if [[ -x "$(command -v lxappearance)" ]]; then
    [[ ! -n $NAMES ]] && NAMES="LXappearance" || NAMES="LXappearance\n"$NAMES
fi
if [[ -x "$(command -v arandr)" ]]; then
    [[ ! -n $NAMES ]] && NAMES="Arandr" || NAMES="Arandr\n"$NAMES
fi
if [[ -x "$(command -v pavucontrol)" ]]; then
    [[ ! -n $NAMES ]] && NAMES="Pavucontrol" || NAMES="Pavucontrol\n"$NAMES
fi
if [[ -x "$(command -v gparted)" ]]; then
    [[ ! -n $NAMES ]] && NAMES="GParted" || NAMES="GParted\n"$NAMES
fi
if [[ -x "$(command -v synaptic)" ]]; then
    [[ ! -n $NAMES ]] && NAMES="Synaptic" || NAMES="Synaptic\n"$NAMES
fi
if [[ -x "$(command -v pcmanfm)" ]]; then
    [[ ! -n $NAMES ]] && NAMES="PCmanFm" || NAMES="PCmanFm\n"$NAMES
fi
if [[ ! -n $NAMES ]]; then
    dmenu_run -i -b -p MENU
    exit 0
fi


CHOICE=$(echo -e "$NAMES" | dmenu -i -b -p UTILITY | cut -d ':' -f 1)
case "$CHOICE" in
    PCmanFm)
        _launch "pcmanfm"
        ;;
    Synaptic)
        pkexec env DISPLAY=$DISPLAY XAUTHORITY=$XAUTHORITY synaptic
        ;;
    GParted)
        gparted
        ;;
    Pavucontrol)
        pavucontrol
        ;;
    Arandr)
        arandr
        ;;
    LXappearance)
        _launch "lxappearance"
        ;;
    Qt5ct)
        _launch "qt5ct"
        ;;
    *)
        exit 1
        ;;
esac
