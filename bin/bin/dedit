#!/usr/bin/env bash


_launch () {
    NAME="$1"; COMMAND="$2"
    CHOICE=$(echo -e "Open\nWindow\n\$HOME" | dmenu -i -b -p $NAME | cut -d ':' -f 1)
    case "$CHOICE" in
        Open)
            $COMMAND
            ;;
        Window)
            $COMMAND --new-window
            ;;
        \$HOME)
            $COMMAND $HOME
            ;;
        *)
            exit 1
            ;;
    esac
}


if [[ -x "$(command -v gvim)" ]]; then
    NAMES="Gvim"
fi

if [[ -x "$(command -v codium)" ]]; then
    [[ ! -n $NAMES ]] && NAMES="Codium" || NAMES="Codium\n"$NAMES
fi

if [[ -x "$(command -v code)" ]]; then
    [[ ! -n $NAMES ]] && NAMES="Code" || NAMES="Code\n"$NAMES
fi

if [[ ! -n $NAMES ]]; then
    dmenu_run -i -b -p MENU
    exit 0
fi


CHOICE=$(echo -e "$NAMES" | dmenu -i -b -p EDITOR | cut -d ':' -f 1)
case "$CHOICE" in
    Code)
        _launch "CODE" "code"
        ;;
    Codium)
        _launch "CODIUM" "codium"
        ;;
    Gvim)
        gvim
        ;;
    *)
        exit 1
        ;;
esac
