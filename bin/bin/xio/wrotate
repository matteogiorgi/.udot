#!/usr/bin/env bash

# colors
RED='\033[1;36m'
YLW='\033[1;35m'
NC='\033[0m'

XWACOMID=$(xinput | grep "$WACOMID" | awk -v k=id '{for(i=2;i<=NF;i++) {split($i,a,"="); m[a[1]]=a[2]} print m[k]}')


printf "${RED}%s${NC}\n" "Rotata wacom"
printf "%s${YLW}%s${NC}\n" "  (1) " "0°"
printf "%s${YLW}%s${NC}\n" "  (2) " "90°"
printf "%s${YLW}%s${NC}\n" "  (3) " "180°"
printf "%s${YLW}%s${NC}\n" "  (4) " "270°"
printf "${RED}%s${NC} " "Enter an index (1-4):"


while read response; do
    if [[ $(xinput | grep "$WACOMID" | wc -l) -eq 0 ]]; then
        printf "${YLW}%s${NC}\n" "Wacom not conected"
        exit 1
    fi

    case $response in
        1)
            ROTATION="none"
            printf "${RED}%s${YLW}%s${NC}\n" "Rotation by " "0°"
            break
            ;;
        2)
            ROTATION="ccw"
            printf "${RED}%s${YLW}%s${NC}\n" "Rotation by " "90°"
            break
            ;;
        3)
            ROTATION="half"
            printf "${RED}%s${YLW}%s${NC}\n" "Rotation by " "180°"
            break
            ;;
        4)
            ROTATION="cw"
            printf "${RED}%s${YLW}%s${NC}\n" "Rotation by " "270°"
            break
            ;;
        *)
            printf "${RED}%s${NC} " "Enter an index (1-4):"
            ;;
    esac
done

xsetwacom --set $XWACOMID Rotate $ROTATION


unset RED
unset YLW
unset NC
unset XWACOMID
unset ROTATION
unset response
