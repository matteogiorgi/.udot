#!/usr/bin/env bash


if [[ -x "$(command -v urxvt)" ]]; then
    TERMIAL_NAMES="Urxvt"
fi
if [[ -x "$(command -v st)" ]]; then
    [[ ! -n $TERMIAL_NAMES ]] && TERMIAL_NAMES="ST" || TERMIAL_NAMES="ST\n"$TERMIAL_NAMES
fi
if [[ -x "$(command -v lxterminal)" ]]; then
    [[ ! -n $TERMIAL_NAMES ]] && TERMIAL_NAMES="LXTerminal" || TERMIAL_NAMES="LXTerminal\n"$TERMIAL_NAMES
fi
if [[ -x "$(command -v kitty)" ]]; then
    GLX=$(glxinfo | awk '/OpenGL version/ {print $4}')
    if (( $(echo "$GLX > 3.3" | bc -l) )); then
        [[ ! -n $TERMIAL_NAMES ]] && TERMIAL_NAMES="Kitty" || TERMIAL_NAMES="Kitty\n"$TERMIAL_NAMES
    fi
fi
if [[ ! -n $TERMIAL_NAMES ]]; then
    dmenu_run -i -b -p MENU
    exit 0
fi


TERMINAL_CHOICE=$(echo -e "$TERMIAL_NAMES" | dmenu -i -b -p TERMINAL | cut -d ':' -f 1)
case "$TERMINAL_CHOICE" in
    Kitty)
        kitty
        ;;
    LXTerminal)
        lxterminal
        ;;
    ST)
        st
        ;;
    Urxvt)
        urxvt
        ;;
    *)
        exit 1
        ;;
esac
